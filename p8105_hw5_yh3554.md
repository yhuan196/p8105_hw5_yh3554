p8105_hw5_yh3554
================

## Problem 1

First create a dataframe `full_df`that includes all data files from the
directory `data/`and complete path to each file. Then use `map` over
paths and read data using the `read_csv` function.

``` r
full_df = 
  tibble(
    files = list.files("data/"),
    path = str_c("data/", files)
  ) %>% 
  mutate(data = map(path, read_csv)) %>% 
  unnest(cols = c(data))
```

To tidy data dataframe need to use string manipulations on the file,
converting from wide to long, and selecting relevant variables.

``` r
tidy_df = 
  full_df %>% 
  mutate(
    files = str_replace(files, ".csv", ""),
    group = str_sub(files, 1, 3)) %>% 
  pivot_longer(
    week_1:week_8,
    names_to = "week",
    values_to = "outcome",
    names_prefix = "week_") %>% 
  mutate(week = as.numeric(week)) %>% 
  select(group, subj = files, week, outcome)
```

Creates a plot showing individual data, faceted by group.

``` r
tidy_df %>% 
  ggplot(aes(x = week, y = outcome, group = subj, color = group)) + 
  geom_point() + 
  geom_path() + 
  facet_grid(~group)
```

<img src="p8105_hw5_yh3554_files/figure-gfm/unnamed-chunk-3-1.png" width="90%" />

Based on the spaghetti plots, the outcome of experiment group increase
over time, but the control group not change much over time. The plots
suggest high within-subject correlation – subjects who start above
average end up above average, and those that start below average end up
below average.

## Problem 2

#### Read the data

``` r
homicide_df = read_csv("data_homicide/homicide-data.csv", show_col_types = FALSE)
```

#### Table of proportion of missing data

``` r
homicide_df %>% 
  summarise_at(vars(lat:disposition), .funs = function(x) mean(is.na(x))) %>%
  knitr::kable()
```

|       lat |       lon | disposition |
|----------:|----------:|------------:|
| 0.0011499 | 0.0011499 |           0 |

#### Describle the raw data

The `homicide_df` is data contains homicides in 50 large U.S. It has
52179 variables and 12 cases. The key variables are unique id, victim
demographic information (first name, last name, age, sex), the location
(city, state, latitude, longitude), and disposition. It has 60 missing
latitude information and 60 missing longitude information.

#### Generate new dataframe

Create `city_state` variable by combining city and state variales. Then
summarize within citries to obtain the total number of homicides and
number of unsolved homicides (disposition is “Closed without arrest” or
“Open/No arrest”).

``` r
homicide_tidy <- homicide_df %>% 
  mutate(
    city_state = str_c(city, state, sep = ", ")) %>%
  group_by(city_state) %>%
  summarize(
    homi_tot = n(),
    homi_unsolved = sum(disposition == "Closed without arrest") 
    + sum(disposition == "Open/No arrest" )
  ) %>%
  arrange(desc(homi_tot))

head(homicide_tidy)
```

    ## # A tibble: 6 × 3
    ##   city_state       homi_tot homi_unsolved
    ##   <chr>               <int>         <int>
    ## 1 Chicago, IL          5535          4073
    ## 2 Philadelphia, PA     3037          1360
    ## 3 Houston, TX          2942          1493
    ## 4 Baltimore, MD        2827          1825
    ## 5 Detroit, MI          2519          1482
    ## 6 Los Angeles, CA      2257          1106
